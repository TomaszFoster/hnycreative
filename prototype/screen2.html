<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/foundation.css" />
    <link rel="stylesheet" href="css/style.css" />
    <script src="js/vendor/modernizr.js"></script>
    
  </head>
  <body>

    <div class="row">
      <div class="small-6 columns">
        <!-- New Business / QR / Sort Button -->
        <a href="/screen1.html" class="button small" id="newBusiness">+ New Business</a>
        <button href="#" class="button small" id="printQR" onclick="sendQR()">Print QR</button>
      </div>
      <div class="small-6 columns">
        <div class="small-3 columns">
          <label class="inline right">Sort</label>
        </div>
        <div class="small-9 columns">
          <select id="sortCategory">
            <option></option>
            <option value="opt1">Option1</option>
            <option value="opt2">Option2</option>
            <option value="opt3">Option3</option>
            <option value="opt4">Option4</option>
          </select>
        </div>
      </div>
    </div>
        
    <div class="row">  
      <div class="small-12 columns">
        <div class="small-6 columns">
          <p>Store</p>
        </div>
        <div class="small-2 columns">
          <p>Status</p>
        </div>
        <div class="small-2 columns">
          <p>Last Visited</p>
        </div>
        <div class="small-2 columns">
          <p>Next Visit</p>
        </div>

        <hr>

        <div class="small-6 columns">
          <div class="small-1 columns">
            <input class="bCheckbox" type="checkbox" disabled="disabled" id="firstCheck"/>
          </div>
          <div class="small-11 columns">
            <p class="bName"></p>
            <p class="bAddress"></p>
            <p class="bAddress2"></p>
          </div>
        </div>
        <div class="small-2 columns">
          <p class="bStatus"></p>
        </div>
        <div class="small-2 columns">
          <p class="bLastVisit"></p>
        </div>
        <div class="small-2 columns">
          <p class="bNextVisit"></p>
        </div>

        <hr>

        <div class="small-6 columns">
          <div class="small-1 columns">
            <input class="bCheckbox" type="checkbox" disabled="disabled"/>
          </div>
          <div class="small-11 columns">
            <p class="bName"></p>
            <p class="bAddress"></p>
            <p class="bAddress2"></p>
          </div>
        </div>
        <div class="small-2 columns">
          <p class="bStatus"></p>
        </div>
        <div class="small-2 columns">
          <p class="bLastVisit"></p>
        </div>
        <div class="small-2 columns">
          <p class="bNextVisit"></p>
        </div>

        <hr>

        <!-- Disabled Rows -->

        <div class="small-6 columns">
          <div class="small-1 columns">
            <input class="bCheckbox" type="checkbox" disabled="disabled"/>
          </div>
          <div class="small-11 columns">
            <p class="bName"></p>
            <p class="bAddress"></p>
            <p class="bAddress2"></p>
          </div>
        </div>
        <div class="small-2 columns">
          <p class="bStatus"></p>
        </div>
        <div class="small-2 columns">
          <p class="bLastVisit"></p>
        </div>
        <div class="small-2 columns">
          <p class="bNextVisit"></p>
        </div>

        <hr>

        <div class="small-6 columns">
          <div class="small-1 columns">
            <input class="bCheckbox" type="checkbox" disabled="disabled"/>
          </div>
          <div class="small-11 columns">
            <p class="bName"></p>
            <p class="bAddress"></p>
            <p class="bAddress2"></p>
          </div>
        </div>
        <div class="small-2 columns">
          <p class="bStatus"></p>
        </div>
        <div class="small-2 columns">
          <p class="bLastVisit"></p>
        </div>
        <div class="small-2 columns">
          <p class="bNextVisit"></p>
        </div>

        <hr>

        <!-- Links for Pagination -->
        <!-- Basic style to make the list of page indexes appear inline -->
        <style>
        .paginationLinks li { display: inline;}
        </style>

        <div class="small-4 push-4 columns">
            <ul class="paginationLinks">
              <li><button class="button tiny"> < </button></li>
              <li><a href="#">1</a></li>
              <li><a href="#">2</a></li>
              <li><a href="#">3</a></li>
              <li><button class="button tiny"> > </button></li>
            </ul>
          
        </div>

      </div>
    </div>
    
    <script src="js/vendor/jquery.js"></script>
    <script src="js/foundation.min.js"></script>
    <script>
      $(document).foundation();
      var objectCount = 0;
      $.ajax({
          url: "http://localhost/getBusinessInfo.php",
          type: "GET",
          dataType: "json",
          success: function (incomingJson) {
            //console.log(incomingJson);
            populateInfo(incomingJson);
            
          },
          error: function(response) {
              console.log(response);
              console.log('Test failed!');                  
          }
      });       

      function populateInfo(incomingJson){
        //console.log(incomingJson);
        var i = 0;
        for(a in incomingJson){
          objectCount++;
          jsonInfo = incomingJson[a];
          //console.log(jsonInfo);
          $('.bCheckbox:eq('+i+')').removeAttr("disabled");
          $('.bCheckbox:eq('+i+')').attr("value",a);
          $('.bName:eq('+i+')').html(jsonInfo['bName']);
          $('.bAddress:eq('+i+')').html(jsonInfo['bAddress']);
          $('.bAddress2:eq('+i+')').html(jsonInfo['bAddress2']);
          $('.bLastVisit:eq('+i+')').html(jsonInfo['bLastVisit']);
          $('.bNextVisit:eq('+i+')').html(jsonInfo['bNextVisit']);
          $('.bStatus:eq('+i+')').html(jsonInfo['bStatus']);
          i++;
        }
      }

      function sendQR(){
        var checkArray = [];
        for (i=0;i<objectCount;i++){ 
          if( $('.bCheckbox:eq('+i+'):checked').val()?true:false ){
            checkArray.push( $('.bCheckbox:eq('+i+')').val() );
          }
        }

        console.log(checkArray);

        $.ajax({
            url: "http://localhost/printQR.php",
            type: "POST",
            data:  { 'QRToPrint': checkArray },
            dataType: "json",
            success: function (jsonStr) {
                console.log(jsonStr);
            },
            error: function(response) {
                console.log(response);
                console.log('Test failed!');                  
            }
        }); 
      }


    </script>
  </body>
</html>
