<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/foundation.css" />
    <link rel="stylesheet" href="css/style.css" />
    <style>
      @font-face {
        font-family: 'Kreon-Regular';
        src: url('Kreon-Regular.ttf');
      }
      @font-face {
        font-family: 'Kreon-Bold';
        src: url('Kreon-Bold.ttf');
      }
      @font-face {
        font-family: 'Mathlete-Bulky';
        src: url('Mathlete-Bulky.otf') format('opentype');
      }
      @font-face {
        font-family: 'Kreon-Light';
        src: url('Kreon-Light.ttf');
      }
      h2, .bReward {
        font-family: 'Kreon' !important;
      }
    </style>

    <script src="js/OpenLayers.js"></script>
    <script>
      function init() {
        map = new OpenLayers.Map("basicMap");
        var mapnik         = new OpenLayers.Layer.OSM();
        var fromProjection = new OpenLayers.Projection("EPSG:4326");   // Transform from WGS 1984
        var toProjection   = new OpenLayers.Projection("EPSG:900913"); // to Spherical Mercator Projection
        var position       = new OpenLayers.LonLat(-76.2944327,36.8700092).transform( fromProjection, toProjection);
        var zoom           = 15; 
 
        map.addLayer(mapnik);
        map.setCenter(position, zoom );
      }
    </script>
    <script src="js/vendor/modernizr.js"></script>
  </head>

  <body onload="init();">

  <!-- OffCanvas Menu / Navigation -->
    <nav class="tab-bar">
      <section class="left-small">
        <a onclick="history.back();"><img class="menu-left-arrow" src="img/leftButtonArrow.png" /></a>
      </section>

      <section class="middle tab-bar-section text-center">
        <h1 class="title" id="title">Be A Local LoveVA</h1>
      </section>
      
    </nav>

    <section class="business-detail-page">

      <!-- Actual Main Section -->

      <div class="row reward-first">
        <div class="small-12 columns">
          <div class="business-logo">
          </div>
          <div class="business-logo-icon text-center">
            <img class="bLogo"/>
          </div>
          <h2 class="bName">Business Detail</h2>
        </div>
      </div>

      <div class="row reward-details">
        <div class="small-12 columns">
          <h4><img class="mini-heart" src="img/miniRedHeart.png"/> Local LoveVA Reward:</h4>
          <h3 class="bReward">FREE Desert With Dinner Purchase</h3>
          <p class="bRewardDetail reward-detail-text"></p>
          
        </div>
      </div>
      <div class="row redeem-button-container">
        <div class="small-12 columns text-center">
          <a href="#" class="button large redeem-button"><img src="img/whiteGiftIcon.png"/>Redeem This Reward</a>
        </div>
      </div>

      <!-- Dynamic Map Section -->

      <div class="row business-map">
        <div class="small-12 columns business-map-container">
          <div id="basicMap" style="width:100%;height:100%;"></div>
        </div>
      </div>

      <!-- -->

      <div class="row business-detail-list">
        <div class="small-12 columns">
          <h2><img src="img/directionIcon.png"/>Directions</h2>
          <p class="bFullAddress">313 West 21st Street</p>
        </div>
        <div class="small-12 columns">
          <h2><img src="img/callIcon.png"/>Call Now</h2>
        </div>
        <div class="small-12 columns">
          <h2><img src="img/learnMoreIcon.png"/>Learn More</h2>
          
          <a class="right bDirections">Open in Maps</a>
        </div>
      </div>

      <div class="row">
        <div class="small-4 columns">
          <h2>Phone:</h2>
        </div>
        <div class="small-8 columns">
          <p class="bPhone"></p>
          <a href="#" class="button right bPhoneCall">Call Now</a>
        </div>
      </div>

      <div class="row">
        <div class="small-4 columns">
          <h2>Website:</h2>
        </div>
        <div class="small-8 columns">
          <a class="bWebsite"></a>
        </div>
      </div>

      <div class="row">
        <div class="small-12 columns">
          <ul class="small-block-grid-4">
            <!-- Placeholders for the social media icons on the bottom -->
            <li><a href="#"><img src=""/></a></li>
            <li><a href="#"><img src=""/></a></li>
            <li><a href="#"><img src=""/></a></li>
            <li><a href="#"><img src=""/></a></li>
          </ul>
        </div>
      </div>

    <!-- close the off-canvas menu -->
    </section>

    <script src="js/vendor/jquery.js"></script>
    <script src="js/foundation.min.js"></script>
    <script>
      $(document).foundation();

      $.ajax({
          url: "getBusinessInfo.php",
          type: "GET",
          dataType: "json",
          success: function (incomingJson) {
            //console.log(incomingJson);
            populateInfo(incomingJson);
          },
          error: function(response) {
              console.log(response);
              console.log('Test failed!');                  
          }
      });

      function populateInfo(incomingJson){
        //console.log(incomingJson);
        jsonInfo = incomingJson['11782'];
        $('.bLogo').attr("src",jsonInfo['bLogo']);
        $('.bWebsite').attr("href",jsonInfo['bWebsite']);
        $('.bWebsite').html(jsonInfo['bWebsite'].substr(7));
        $('.bPhone').html(jsonInfo['bPhone']);
        $('.bRewardDetail').html(jsonInfo['bRewardDetail']);
        $('.bPhoneCall').attr("href", "tel:"+jsonInfo['bPhone']);
        $('.bDirections').attr("href", jsonInfo['bDirections']);
        $('.bFullAddress').html(jsonInfo['bAddress']+", "+jsonInfo['bCity']+", "+jsonInfo['bState']+
          " "+jsonInfo['bZip']);
        $('.bCategories').html(jsonInfo['bCategory']+" | "+jsonInfo['bSubCat1']+
          " | "+jsonInfo['bSubCat2']+" | "+jsonInfo['bSubCat3']);
      }
    </script>
  </body>
</html>
