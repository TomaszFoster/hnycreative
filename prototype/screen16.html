<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/foundation.css" />
    <style>
      @font-face {
        font-family: 'Kreon';
        src: url('Kreon-Regular.ttf');
      }
      h2, .bReward {
        font-family: 'Kreon' !important;
      }
    </style>
    <script src="js/vendor/modernizr.js"></script>
  </head>
  <body>

    <!-- Back Button -->
    <div class="row">
      <div class="small-12 columns">
        <a href="#" class="button">Back</a>
      </div>
    </div>

    <div class="row">
      <div class="small-12 columns text-center">
        <img class="bRewardImage" src="img/small.png" />
        <h2 class="bReward"></h2>
        <p class="bRewardDetail"></p>
        <h3 class="bName"></h3><button id="storeHourDisplay" class="button">Closed</button>
        <a href="#" class="button large bDirections">Get Directions</a><br>
        <a href="#" class="button large">Store Details</a>
      </div>
    </div>

    <script src="js/vendor/jquery.js"></script>
    <script src="js/foundation.min.js"></script>
    <script>
      $(document).foundation();

      $.ajax({
          url: "http://localhost/getBusinessInfo.php",
          type: "GET",
          dataType: "json",
          success: function (incomingJson) {
            console.log(incomingJson);
            populateInfo(incomingJson);
          },
          error: function(response) {
              console.log(response);
              console.log('Test failed!');                  
          }
      }); 

      function populateInfo(incomingJson){
          //console.log(incomingJson);
          jsonInfo = incomingJson['11782'];
          $('.bName').html(jsonInfo['bName']);
          $('.bReward').html(jsonInfo['bReward']);
          $('.bRewardDetail').html(jsonInfo['bRewardDetail']);
          $('.bRewardImage').attr("src", jsonInfo['bRewardImage']);
          //$('.latestBadgeLocation').html(jsonInfo['latestBadgeLocation']);
          $('.bDirections').attr("href", jsonInfo['bDirections']);
          compareDate(jsonInfo);
      }

      // here we compare todays date and time against store hours
      function compareDate(jsonInfo){
        var d = new Date();
        var day = d.getDay();
        var dayOfWeek;
        switch (day){
          case 0:
              dayOfWeek = "Sunday";
              break;
          case 1:
            dayOfWeek = "Monday";
            break;
          case 2:
            dayOfWeek = "Tuesday";
            break;
          case 3:
            dayOfWeek = "Wednesday";
            break;
          case 4:
            dayOfWeek = "Thursday";
            break;
          case 5:
            dayOfWeek = "Friday";
            break;
          case 6:
            dayOfWeek = "Saturday";
            break;
        }

        var hours = d.getHours();
        var minutes = d.getMinutes();
        var currentTime=(hours*100)+minutes;
        if(currentTime>=jsonInfo[dayOfWeek+'1']&&currentTime<=jsonInfo[dayOfWeek+'2']){
          $('#storeHourDisplay').html('Now Open!');
        }
      }
      
      
    </script>
  </body>
</html>
